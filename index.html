<canvas
    width=500
    height=500
    id='mandelwat'
    style="border: 1px solid red;">
</canvas>
<input id="zoom" type="range" value="0.3" min="0.5" max="100">
<input id="iterations" type="range" value="100" min="1.0" max="5000">


<script id="2d-vertex-shader" type="notjs">
    attribute vec2 a_position;
    void main() {
        gl_Position = vec4(a_position, 0, 1);
    }
</script>

<script id="2d-fragment-shader" type="x-shader/x-fragment">// <![CDATA[

    precision mediump float;
    uniform vec2 xy;
    uniform vec2 center;
    uniform float r;
    uniform float wat;
    uniform float iterations;

    void main() {
        vec3 col = vec3(0.0);

        vec2 p = -(xy - 2.0 * gl_FragCoord.xy) / xy.y * r + center;

        float l = 1.0;

        vec2 z  = vec2(0.0);
        vec2 c = vec2(p.x, p.y);
        for( float i = 0.0; i < 100000.0; i++ ) {
            // z = z*z + c
            z = vec2( z.x*z.x - z.y*z.y, 2.0*z.x*z.y ) + c;

            if( dot(z,z)>(4.0) ) {
                col += 0.5 + 0.5*cos( 3.0 + l*0.15 + vec3(0.0,0.6,1.0));

                // col += -((l / iterations) - 1.0);
                break;
            }
            if( i > iterations ) {
                break;
            }

            l += 1.0;
        }

        gl_FragColor = vec4( col, 1.0 );
    }
</script>

<!-- <script src='./mandelwat.js'></script> -->
<script src='./mandelgl.js'></script>
